{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\Desktop\\\\\\u96F2\\u6E67\\u667A\\u751F\\\\happysing_aws\\\\frontend\\\\src\\\\pages\\\\CasePage.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { PaperAirplaneIcon } from '@heroicons/react/24/outline';\nimport './Home.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction fileToBase64(file) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = () => resolve(reader.result);\n    reader.onerror = reject;\n    reader.readAsDataURL(file);\n  });\n}\nasync function uploadImageToS3(file, userId = \"default-user\") {\n  const timestamp = Date.now();\n  const filename = file.name;\n  const uploadPath = `uploads/${userId}/${timestamp}_${filename}`;\n  const uploadUrl = `https://coolermaster-ai-generated.s3.amazonaws.com/${uploadPath}`;\n  try {\n    const uploadResponse = await fetch(uploadUrl, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': file.type || 'image/png'\n      },\n      body: file\n    });\n\n    // 👉 Just warn if not ok, but don't treat as hard fail\n    if (!uploadResponse.ok && uploadResponse.status !== 200 && uploadResponse.status !== 204) {\n      console.warn('[⚠️ Upload status not perfect, but assuming success]', uploadResponse.status);\n    }\n    console.log('[✅ Uploaded Successfully] to', uploadUrl);\n    return uploadUrl;\n  } catch (error) {\n    console.error('[❌ Upload Failed]:', error);\n    throw new Error('Upload to S3 failed');\n  }\n}\nconst CasePage = () => {\n  _s();\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(false);\n  const [currentPrompt, setCurrentPrompt] = useState('');\n  const [baseImage, setBaseImage] = useState(null);\n  const [referenceImage, setReferenceImage] = useState(null);\n  const [timelineNodes, setTimelineNodes] = useState([]);\n  const [availableImages, setAvailableImages] = useState([]);\n  const [showImages, setShowImages] = useState(false);\n  const [loadingImages, setLoadingImages] = useState(false);\n  const [imageError, setImageError] = useState(null);\n  useEffect(() => {\n    const stored = localStorage.getItem('case-history');\n    if (stored) {\n      try {\n        const history = JSON.parse(stored);\n        setTimelineNodes(history.map((item, index) => ({\n          id: `node-${index}`,\n          data: {\n            prompt: item.prompt,\n            timestamp: item.timestamp || Date.now(),\n            tags: ['主機外殼'],\n            imageUrl: item.imageUrl || null\n          }\n        })));\n      } catch (error) {\n        console.error('Error parsing case history:', error);\n      }\n    }\n  }, []);\n  async function callPromptBooster(promptText, referenceImage) {\n    let referenceImageBase64 = null;\n    if (referenceImage) {\n      referenceImageBase64 = await fileToBase64(referenceImage);\n    }\n    const body = {\n      user_prompt: promptText,\n      inspiration_image_ids: [],\n      use_trends: true\n    };\n    if (referenceImageBase64) {\n      body.inspiration_images_base64 = [referenceImageBase64];\n    }\n    console.log('[DEBUG] Sending to API:', body); // 💬 Debugging log\n\n    const response = await fetch('https://409etc6v1f.execute-api.us-west-2.amazonaws.com/promptbooster', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(body)\n    });\n    const data = await response.json();\n    console.log('[DEBUG] API Response:', data); // 💬 Debugging log\n    return data.boosted_prompt;\n  }\n  const handlePromptSubmit = async (promptText, original) => {\n    setLoading(true);\n    try {\n      // Send both the prompt and the reference image (if available) to the API\n      const boostedPrompt = await callPromptBooster(promptText, referenceImage);\n      const newHistoryItem = {\n        prompt: promptText,\n        timestamp: Date.now()\n      };\n      const stored = localStorage.getItem('case-history');\n      const history = stored ? JSON.parse(stored) : [];\n      history.push(newHistoryItem);\n      localStorage.setItem('case-history', JSON.stringify(history));\n      setTimelineNodes(prevNodes => [...prevNodes, {\n        id: `node-${prevNodes.length}`,\n        data: {\n          prompt: promptText,\n          timestamp: newHistoryItem.timestamp,\n          tags: ['主機外殼'],\n          imageUrl: null\n        }\n      }]);\n\n      // Now pass reference image along with the boosted prompt\n      navigate('/generator', {\n        state: {\n          productType: 'case',\n          prompt: original,\n          boostedPrompt: boostedPrompt,\n          baseImage: baseImage ? URL.createObjectURL(baseImage) : null,\n          referencemage: referenceImage ? URL.createObjectURL(referenceImage) : null // Send the reference image to generator\n        }\n      });\n    } catch (error) {\n      console.error('Error boosting prompt:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const openImageSelector = () => {\n    navigate('/select-image');\n  };\n  const handleSelectImage = async img => {\n    try {\n      const response = await fetch(img.url);\n      if (!response.ok) throw new Error('圖片載入失敗');\n      const blob = await response.blob();\n      const file = new File([blob], img.description + '.jpg', {\n        type: blob.type\n      });\n      setBaseImage(file);\n      setShowImages(false);\n    } catch (error) {\n      console.error('選擇圖片失敗', error);\n      setImageError('選擇圖片失敗，請稍後再試');\n    }\n  };\n  const handleFileChange = async (event, type) => {\n    var _event$target$files;\n    const file = ((_event$target$files = event.target.files) === null || _event$target$files === void 0 ? void 0 : _event$target$files[0]) || null;\n    if (!file) return;\n    if (type === 'reference') {\n      setReferenceImage(file);\n    } else if (type === 'base') {\n      try {\n        const uploadedUrl = await uploadImageToS3(file);\n        localStorage.setItem('selectedBaseImageUrl', uploadedUrl);\n\n        // 👉 fetch uploaded file and update baseImage\n        const uploadedBlob = await fetch(uploadedUrl).then(res => res.blob());\n        const uploadedFile = new File([uploadedBlob], file.name, {\n          type: file.type\n        });\n        setBaseImage(uploadedFile);\n        console.log('[✅ Base image updated after upload]');\n      } catch (error) {\n        console.error('Failed to upload base image:', error);\n        alert('上傳失敗，請稍後再試');\n      }\n    }\n  };\n  const handleTryLuck = () => {\n    const luckyPrompts = [\"設計一款簡約風格的中塔式機箱，前面板採用鋁合金材質，側板為強化玻璃\", \"打造一款RGB燈效豐富的遊戲機箱，支援360mm水冷\", \"創造一款極簡風格的ITX小型機箱，優化空間利用率與散熱\", \"設計一款未來科技感的開放式機箱，突顯內部組件\"];\n    const randomPrompt = luckyPrompts[Math.floor(Math.random() * luckyPrompts.length)];\n    setCurrentPrompt(randomPrompt);\n    handlePromptSubmit(randomPrompt, randomPrompt);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"home-container pb-24\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"content-container max-w-2xl mx-auto p-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => navigate('/'),\n          className: \"flex items-center text-black hover:text-gray-700\",\n          children: \"\\u8FD4\\u56DE\\u9078\\u64C7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex gap-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => navigate('/timeline', {\n              state: {\n                productType: 'case'\n              }\n            }),\n            className: \"bg-purple-600 text-white px-4 py-2 rounded-lg\",\n            children: \"\\u6B77\\u53F2\\u8A18\\u9304\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 236,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => navigate('/mindmap', {\n              state: {\n                productType: 'case'\n              }\n            }),\n            className: \"bg-purple-600 text-white px-4 py-2 rounded-lg\",\n            children: \"\\u5FC3\\u667A\\u5716\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-3xl font-bold text-center mb-4 text-black\",\n        children: \"\\u4E3B\\u6A5F\\u5916\\u6BBC\\u8A2D\\u8A08\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full flex justify-center mb-8\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleTryLuck,\n          className: \"px-6 py-3 bg-gradient-to-r from-purple-500 to-indigo-600 text-white font-bold rounded-lg hover:from-purple-600 hover:to-indigo-700 shadow-lg\",\n          children: \"\\u8A66\\u624B\\u6C23\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white border border-purple-200 rounded-xl p-4 mb-6 flex items-end space-x-2 shadow-lg\",\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: currentPrompt,\n          onChange: e => {\n            setCurrentPrompt(e.target.value);\n            e.target.style.height = 'auto';\n            e.target.style.height = e.target.scrollHeight + 'px';\n          },\n          onKeyDown: async e => {\n            if (e.key === 'Enter' && !e.shiftKey && currentPrompt.trim()) {\n              e.preventDefault();\n              const boostedPrompt = await callPromptBooster(currentPrompt.trim());\n              handlePromptSubmit(boostedPrompt, currentPrompt.trim());\n            }\n          },\n          placeholder: \"\\u63CF\\u8FF0\\u60A8\\u7406\\u60F3\\u4E2D\\u7684\\u4E3B\\u6A5F\\u5916\\u6BBC\\u8A2D\\u8A08...\",\n          rows: 1,\n          className: \"flex-1 resize-none overflow-hidden bg-white text-gray-800 placeholder-purple-400 focus:outline-none\",\n          disabled: loading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => currentPrompt.trim() && handlePromptSubmit(currentPrompt.trim(), currentPrompt.trim()),\n          disabled: loading || !currentPrompt.trim(),\n          className: \"p-2 rounded-md bg-purple-600 hover:bg-purple-700 text-white\",\n          children: /*#__PURE__*/_jsxDEV(PaperAirplaneIcon, {\n            className: \"w-5 h-5\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-2 gap-4 mb-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white rounded-lg shadow-md p-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-md font-extrabold mb-3 text-black font-inter\",\n            children: \"\\u9078\\u64C7 Base Image\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-col gap-4 items-center relative\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-full flex justify-between items-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"file\",\n                accept: \"image/*\",\n                onChange: e => handleFileChange(e, 'base'),\n                className: \"block text-sm text-gray-500\\r file:mr-4 file:py-2 file:px-4 \\r file:rounded-full file:border-0 \\r file:bg-purple-50 file:text-purple-700 \\r hover:file:bg-purple-100\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 287,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: openImageSelector,\n                disabled: loadingImages,\n                className: \"text-xs py-2 px-4 rounded-full bg-purple-100 text-purple-700 hover:bg-purple-200 disabled:opacity-50 disabled:cursor-not-allowed\",\n                children: loadingImages ? '載入中...' : '從資料庫載入圖片'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 298,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 286,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex flex-col items-center mt-4\",\n              children: baseImage ? /*#__PURE__*/_jsxDEV(\"img\", {\n                src: URL.createObjectURL(baseImage),\n                alt: \"\\u9078\\u64C7\\u7684 Base Image\",\n                className: \"w-32 h-32 object-contain rounded-lg\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 310,\n                columnNumber: 5\n              }, this) : (() => {\n                const selectedImageUrl = localStorage.getItem('selectedBaseImageUrl');\n                if (selectedImageUrl) {\n                  return /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: selectedImageUrl,\n                    alt: \"\\u9078\\u64C7\\u7684 Base Image\",\n                    className: \"w-32 h-32 object-contain rounded-lg\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 320,\n                    columnNumber: 11\n                  }, this);\n                } else {\n                  return /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-sm text-gray-500\",\n                    children: \"\\u672A\\u9078\\u64C7\\u4EFB\\u4F55\\u5716\\u7247\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 328,\n                    columnNumber: 11\n                  }, this);\n                }\n              })()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 308,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 13\n          }, this), imageError && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-2 text-red-500 text-sm\",\n            children: imageError\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 340,\n            columnNumber: 15\n          }, this), showImages && availableImages.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-2 gap-4 mt-4 max-h-64 overflow-y-auto\",\n            children: availableImages.map(img => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"border rounded p-2 cursor-pointer hover:bg-purple-100 transition-colors\",\n              onClick: () => handleSelectImage(img),\n              children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                src: img.url,\n                alt: img.description,\n                className: \"w-full h-24 object-cover rounded\",\n                onError: () => setImageError('圖片載入失敗')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 352,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xs text-center truncate\",\n                  children: img.description\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 359,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xs text-gray-500 text-center mt-1\",\n                  children: new Date(img.created_at).toLocaleDateString()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 360,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 358,\n                columnNumber: 21\n              }, this)]\n            }, img.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 347,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 345,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white rounded-lg shadow-md p-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-md font-extrabold mb-3 text-black font-inter\",\n            children: \"Upload Reference Image\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 373,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            accept: \"image/*\",\n            onChange: e => handleFileChange(e, 'reference'),\n            className: \"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:bg-purple-50 file:text-purple-700 hover:file:bg-purple-100\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 374,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 372,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-lg shadow-lg p-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-lg font-semibold mb-4 text-gray-900\",\n          children: \"Chats in this project\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 11\n        }, this), timelineNodes.length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: timelineNodes.map((node, index) => {\n            var _node$data$tags;\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"p-3 bg-white rounded-md hover:bg-purple-50 transition-colors shadow-lg\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-start justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  onClick: () => setCurrentPrompt(node.data.prompt),\n                  className: \"flex items-start space-x-3 cursor-pointer flex-1\",\n                  children: [node.data.imageUrl && /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: node.data.imageUrl,\n                    alt: node.data.prompt,\n                    className: \"w-12 h-12 object-cover rounded-md\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 388,\n                    columnNumber: 46\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex-1 min-w-0\",\n                    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-sm text-gray-800 truncate\",\n                      children: node.data.prompt\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 390,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex flex-wrap gap-1 mt-1\",\n                      children: (_node$data$tags = node.data.tags) === null || _node$data$tags === void 0 ? void 0 : _node$data$tags.map((tag, idx) => /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"px-2 py-1 text-xs bg-purple-100 text-purple-700 rounded-full\",\n                        children: tag\n                      }, idx, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 393,\n                        columnNumber: 29\n                      }, this))\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 391,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-xs text-gray-500 mt-1\",\n                      children: new Date(node.data.timestamp).toLocaleString()\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 396,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 389,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 387,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => handlePromptSubmit(node.data.prompt, node.data.prompt),\n                  className: \"ml-2 px-3 py-1.5 bg-purple-600 hover:bg-purple-700 text-white text-xs font-medium rounded transition-colors\",\n                  children: \"\\u91CD\\u65B0\\u4F7F\\u7528\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 399,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 386,\n                columnNumber: 19\n              }, this)\n            }, node.id || index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 385,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 383,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-500\",\n          children: \"No history found yet.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 407,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 227,\n    columnNumber: 5\n  }, this);\n};\n_s(CasePage, \"UVN8+qWUSKCIxrH6lDINB7z36Us=\", false, function () {\n  return [useNavigate];\n});\n_c = CasePage;\nexport default CasePage;\nvar _c;\n$RefreshReg$(_c, \"CasePage\");","map":{"version":3,"names":["React","useState","useEffect","useNavigate","PaperAirplaneIcon","jsxDEV","_jsxDEV","fileToBase64","file","Promise","resolve","reject","reader","FileReader","onload","result","onerror","readAsDataURL","uploadImageToS3","userId","timestamp","Date","now","filename","name","uploadPath","uploadUrl","uploadResponse","fetch","method","headers","type","body","ok","status","console","warn","log","error","Error","CasePage","_s","navigate","loading","setLoading","currentPrompt","setCurrentPrompt","baseImage","setBaseImage","referenceImage","setReferenceImage","timelineNodes","setTimelineNodes","availableImages","setAvailableImages","showImages","setShowImages","loadingImages","setLoadingImages","imageError","setImageError","stored","localStorage","getItem","history","JSON","parse","map","item","index","id","data","prompt","tags","imageUrl","callPromptBooster","promptText","referenceImageBase64","user_prompt","inspiration_image_ids","use_trends","inspiration_images_base64","response","stringify","json","boosted_prompt","handlePromptSubmit","original","boostedPrompt","newHistoryItem","push","setItem","prevNodes","length","state","productType","URL","createObjectURL","referencemage","openImageSelector","handleSelectImage","img","url","blob","File","description","handleFileChange","event","_event$target$files","target","files","uploadedUrl","uploadedBlob","then","res","uploadedFile","alert","handleTryLuck","luckyPrompts","randomPrompt","Math","floor","random","className","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","value","onChange","e","style","height","scrollHeight","onKeyDown","key","shiftKey","trim","preventDefault","placeholder","rows","disabled","accept","src","alt","selectedImageUrl","onError","created_at","toLocaleDateString","node","_node$data$tags","tag","idx","toLocaleString","_c","$RefreshReg$"],"sources":["C:/Users/User/Desktop/雲湧智生/happysing_aws/frontend/src/pages/CasePage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { LightBulbIcon, ClockIcon, PaperAirplaneIcon } from '@heroicons/react/24/outline';\r\nimport './Home.css';\r\nimport { Timeline } from '../components/Timeline';\r\nimport ChatInput from '../components/ChatInput';\r\n\r\nfunction fileToBase64(file: File): Promise<string> {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.onload = () => resolve(reader.result as string);\r\n    reader.onerror = reject;\r\n    reader.readAsDataURL(file);\r\n  });\r\n}\r\n\r\nasync function uploadImageToS3(file: File, userId: string = \"default-user\"): Promise<string> {\r\n  const timestamp = Date.now();\r\n  const filename = file.name;\r\n  \r\n  const uploadPath = `uploads/${userId}/${timestamp}_${filename}`;\r\n  const uploadUrl = `https://coolermaster-ai-generated.s3.amazonaws.com/${uploadPath}`;\r\n\r\n  try {\r\n    const uploadResponse = await fetch(uploadUrl, {\r\n      method: 'PUT',\r\n      headers: {\r\n        'Content-Type': file.type || 'image/png'\r\n      },\r\n      body: file\r\n    });\r\n\r\n    // 👉 Just warn if not ok, but don't treat as hard fail\r\n    if (!uploadResponse.ok && uploadResponse.status !== 200 && uploadResponse.status !== 204) {\r\n      console.warn('[⚠️ Upload status not perfect, but assuming success]', uploadResponse.status);\r\n    }\r\n\r\n    console.log('[✅ Uploaded Successfully] to', uploadUrl);\r\n\r\n    return uploadUrl;\r\n  } catch (error) {\r\n    console.error('[❌ Upload Failed]:', error);\r\n    throw new Error('Upload to S3 failed');\r\n  }\r\n}\r\n\r\n\r\nconst CasePage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const [loading, setLoading] = useState(false);\r\n  const [currentPrompt, setCurrentPrompt] = useState('');\r\n  const [baseImage, setBaseImage] = useState<File | null>(null);\r\n  const [referenceImage, setReferenceImage] = useState<File | null>(null);\r\n  const [timelineNodes, setTimelineNodes] = useState<any[]>([]);\r\n  const [availableImages, setAvailableImages] = useState<{ \r\n    id: number;\r\n    url: string; \r\n    description: string;\r\n    created_at: string;\r\n    updated_at: string;\r\n  }[]>([]);\r\n  const [showImages, setShowImages] = useState(false);\r\n  const [loadingImages, setLoadingImages] = useState(false);\r\n  const [imageError, setImageError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const stored = localStorage.getItem('case-history');\r\n    if (stored) {\r\n      try {\r\n        const history = JSON.parse(stored);\r\n        setTimelineNodes(history.map((item: any, index: number) => ({\r\n          id: `node-${index}`,\r\n          data: {\r\n            prompt: item.prompt,\r\n            timestamp: item.timestamp || Date.now(),\r\n            tags: ['主機外殼'],\r\n            imageUrl: item.imageUrl || null\r\n          }\r\n        })));\r\n      } catch (error) {\r\n        console.error('Error parsing case history:', error);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  async function callPromptBooster(promptText: string, referenceImage?: File | null): Promise<string> {\r\n    let referenceImageBase64: string | null = null;\r\n  \r\n    if (referenceImage) {\r\n      referenceImageBase64 = await fileToBase64(referenceImage);\r\n    }\r\n  \r\n    const body: any = {\r\n      user_prompt: promptText,\r\n      inspiration_image_ids: [],\r\n      use_trends: true,\r\n    };\r\n  \r\n    if (referenceImageBase64) {\r\n      body.inspiration_images_base64 = [referenceImageBase64];\r\n    }\r\n  \r\n    console.log('[DEBUG] Sending to API:', body); // 💬 Debugging log\r\n  \r\n    const response = await fetch('https://409etc6v1f.execute-api.us-west-2.amazonaws.com/promptbooster', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify(body),\r\n    });\r\n  \r\n    const data = await response.json();\r\n    console.log('[DEBUG] API Response:', data); // 💬 Debugging log\r\n    return data.boosted_prompt;\r\n  }\r\n  \r\n\r\n  const handlePromptSubmit = async (promptText: string, original: string) => {\r\n    setLoading(true);\r\n    try {\r\n      // Send both the prompt and the reference image (if available) to the API\r\n      const boostedPrompt = await callPromptBooster(promptText, referenceImage);\r\n  \r\n      const newHistoryItem = {\r\n        prompt: promptText,\r\n        timestamp: Date.now(),\r\n      };\r\n  \r\n      const stored = localStorage.getItem('case-history');\r\n      const history = stored ? JSON.parse(stored) : [];\r\n      history.push(newHistoryItem);\r\n      localStorage.setItem('case-history', JSON.stringify(history));\r\n  \r\n      setTimelineNodes((prevNodes) => [\r\n        ...prevNodes,\r\n        {\r\n          id: `node-${prevNodes.length}`,\r\n          data: {\r\n            prompt: promptText,\r\n            timestamp: newHistoryItem.timestamp,\r\n            tags: ['主機外殼'],\r\n            imageUrl: null,\r\n          },\r\n        },\r\n      ]);\r\n  \r\n      // Now pass reference image along with the boosted prompt\r\n      navigate('/generator', {\r\n        state: {\r\n          productType: 'case',\r\n          prompt: original,\r\n          boostedPrompt: boostedPrompt,\r\n          baseImage: baseImage ? URL.createObjectURL(baseImage) : null,\r\n          referencemage: referenceImage ? URL.createObjectURL(referenceImage) : null, // Send the reference image to generator\r\n        },\r\n      });\r\n    } catch (error) {\r\n      console.error('Error boosting prompt:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n  \r\n\r\n  const openImageSelector = () => {\r\n    navigate('/select-image');\r\n  };\r\n\r\n  const handleSelectImage = async (img: { \r\n    id: number;\r\n    url: string; \r\n    description: string;\r\n    created_at: string;\r\n    updated_at: string;\r\n  }) => {\r\n    try {\r\n      const response = await fetch(img.url);\r\n      if (!response.ok) throw new Error('圖片載入失敗');\r\n      const blob = await response.blob();\r\n      const file = new File([blob], img.description + '.jpg', { type: blob.type });\r\n      setBaseImage(file);\r\n      setShowImages(false);\r\n    } catch (error) {\r\n      console.error('選擇圖片失敗', error);\r\n      setImageError('選擇圖片失敗，請稍後再試');\r\n    }\r\n  };\r\n\r\n  const handleFileChange = async (event: React.ChangeEvent<HTMLInputElement>, type: 'base' | 'reference') => {\r\n    const file = event.target.files?.[0] || null;\r\n    if (!file) return;\r\n  \r\n    if (type === 'reference') {\r\n      setReferenceImage(file);\r\n    } else if (type === 'base') {\r\n      try {\r\n        const uploadedUrl = await uploadImageToS3(file);\r\n        localStorage.setItem('selectedBaseImageUrl', uploadedUrl);\r\n  \r\n        // 👉 fetch uploaded file and update baseImage\r\n        const uploadedBlob = await fetch(uploadedUrl).then(res => res.blob());\r\n        const uploadedFile = new File([uploadedBlob], file.name, { type: file.type });\r\n        setBaseImage(uploadedFile);\r\n  \r\n        console.log('[✅ Base image updated after upload]');\r\n      } catch (error) {\r\n        console.error('Failed to upload base image:', error);\r\n        alert('上傳失敗，請稍後再試');\r\n      }\r\n    }\r\n  };  \r\n  \r\n\r\n  const handleTryLuck = () => {\r\n    const luckyPrompts = [\r\n      \"設計一款簡約風格的中塔式機箱，前面板採用鋁合金材質，側板為強化玻璃\",\r\n      \"打造一款RGB燈效豐富的遊戲機箱，支援360mm水冷\",\r\n      \"創造一款極簡風格的ITX小型機箱，優化空間利用率與散熱\",\r\n      \"設計一款未來科技感的開放式機箱，突顯內部組件\"\r\n    ];\r\n    const randomPrompt = luckyPrompts[Math.floor(Math.random() * luckyPrompts.length)];\r\n    setCurrentPrompt(randomPrompt);\r\n    handlePromptSubmit(randomPrompt, randomPrompt);\r\n  };\r\n\r\n  return (\r\n    <div className=\"home-container pb-24\">\r\n      <div className=\"content-container max-w-2xl mx-auto p-6\">\r\n        \r\n        {/* 功能列 */}\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <button onClick={() => navigate('/')} className=\"flex items-center text-black hover:text-gray-700\">\r\n            返回選擇\r\n          </button>\r\n          <div className=\"flex gap-2\">\r\n            <button onClick={() => navigate('/timeline', { state: { productType: 'case' } })} className=\"bg-purple-600 text-white px-4 py-2 rounded-lg\">歷史記錄</button>\r\n            <button onClick={() => navigate('/mindmap', { state: { productType: 'case' } })} className=\"bg-purple-600 text-white px-4 py-2 rounded-lg\">心智圖</button>\r\n          </div>\r\n        </div>\r\n\r\n        <h1 className=\"text-3xl font-bold text-center mb-4 text-black\">主機外殼設計</h1>\r\n\r\n        {/* 試手氣按鈕 */}\r\n        <div className=\"w-full flex justify-center mb-8\">\r\n          <button onClick={handleTryLuck} className=\"px-6 py-3 bg-gradient-to-r from-purple-500 to-indigo-600 text-white font-bold rounded-lg hover:from-purple-600 hover:to-indigo-700 shadow-lg\">\r\n            試手氣\r\n          </button>\r\n        </div>\r\n\r\n        {/* 輸入 Prompt */}\r\n        <div className=\"bg-white border border-purple-200 rounded-xl p-4 mb-6 flex items-end space-x-2 shadow-lg\">\r\n          <textarea\r\n            value={currentPrompt}\r\n            onChange={e => {\r\n              setCurrentPrompt(e.target.value);\r\n              e.target.style.height = 'auto';\r\n              e.target.style.height = e.target.scrollHeight + 'px';\r\n            }}\r\n            onKeyDown={async e => {\r\n              if (e.key === 'Enter' && !e.shiftKey && currentPrompt.trim()) {\r\n                e.preventDefault();\r\n                const boostedPrompt = await callPromptBooster(currentPrompt.trim());\r\n                handlePromptSubmit(boostedPrompt, currentPrompt.trim());\r\n              }\r\n            }}\r\n            placeholder=\"描述您理想中的主機外殼設計...\"\r\n            rows={1}\r\n            className=\"flex-1 resize-none overflow-hidden bg-white text-gray-800 placeholder-purple-400 focus:outline-none\"\r\n            disabled={loading}\r\n          />\r\n          <button onClick={() => currentPrompt.trim() && handlePromptSubmit(currentPrompt.trim(), currentPrompt.trim())} disabled={loading || !currentPrompt.trim()} className=\"p-2 rounded-md bg-purple-600 hover:bg-purple-700 text-white\">\r\n            <PaperAirplaneIcon className=\"w-5 h-5\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* 上傳圖片區塊 */}\r\n        <div className=\"grid grid-cols-2 gap-4 mb-8\">\r\n          \r\n          {/* Base Image 改成從資料庫選 */}\r\n          <div className=\"bg-white rounded-lg shadow-md p-4\">\r\n            <h3 className=\"text-md font-extrabold mb-3 text-black font-inter\">選擇 Base Image</h3>\r\n\r\n            <div className=\"flex flex-col gap-4 items-center relative\">\r\n\r\n              {/* Upload file + Choose dataset buttons on same row */}\r\n              <div className=\"w-full flex justify-between items-center\">\r\n                <input \r\n                  type=\"file\" \r\n                  accept=\"image/*\"\r\n                  onChange={e => handleFileChange(e, 'base')}\r\n                  className=\"block text-sm text-gray-500\r\n                            file:mr-4 file:py-2 file:px-4 \r\n                            file:rounded-full file:border-0 \r\n                            file:bg-purple-50 file:text-purple-700 \r\n                            hover:file:bg-purple-100\"\r\n                />\r\n\r\n                <button\r\n                  onClick={openImageSelector}\r\n                  disabled={loadingImages}\r\n                  className=\"text-xs py-2 px-4 rounded-full bg-purple-100 text-purple-700 hover:bg-purple-200 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                >\r\n                  {loadingImages ? '載入中...' : '從資料庫載入圖片'}\r\n                </button>\r\n              </div>\r\n\r\n              {/* Image Preview below */}\r\n              <div className=\"flex flex-col items-center mt-4\">\r\n  {baseImage ? (\r\n    <img \r\n      src={URL.createObjectURL(baseImage)} \r\n      alt=\"選擇的 Base Image\" \r\n      className=\"w-32 h-32 object-contain rounded-lg\"\r\n    />\r\n  ) : (\r\n    (() => {\r\n      const selectedImageUrl = localStorage.getItem('selectedBaseImageUrl');\r\n      if (selectedImageUrl) {\r\n        return (\r\n          <img \r\n            src={selectedImageUrl} \r\n            alt=\"選擇的 Base Image\" \r\n            className=\"w-32 h-32 object-contain rounded-lg\"\r\n          />\r\n        );\r\n      } else {\r\n        return (\r\n          <span className=\"text-sm text-gray-500\">未選擇任何圖片</span>\r\n        );\r\n      }\r\n    })()\r\n  )}\r\n</div>\r\n\r\n\r\n            </div>\r\n\r\n\r\n            {imageError && (\r\n              <div className=\"mt-2 text-red-500 text-sm\">{imageError}</div>\r\n            )}\r\n\r\n            {/* 只有在 showImages 時才展開圖片列表 */}\r\n            {showImages && availableImages.length > 0 && (\r\n              <div className=\"grid grid-cols-2 gap-4 mt-4 max-h-64 overflow-y-auto\">\r\n                {availableImages.map((img) => (\r\n                  <div\r\n                    key={img.id}\r\n                    className=\"border rounded p-2 cursor-pointer hover:bg-purple-100 transition-colors\"\r\n                    onClick={() => handleSelectImage(img)}\r\n                  >\r\n                    <img \r\n                      src={img.url} \r\n                      alt={img.description} \r\n                      className=\"w-full h-24 object-cover rounded\"\r\n                      onError={() => setImageError('圖片載入失敗')}\r\n                    />\r\n                    <div className=\"mt-2\">\r\n                      <p className=\"text-xs text-center truncate\">{img.description}</p>\r\n                      <p className=\"text-xs text-gray-500 text-center mt-1\">\r\n                        {new Date(img.created_at).toLocaleDateString()}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n\r\n          {/* Reference Image 仍保留上傳 */}\r\n          <div className=\"bg-white rounded-lg shadow-md p-4\">\r\n            <h3 className=\"text-md font-extrabold mb-3 text-black font-inter\">Upload Reference Image</h3>\r\n            <input type=\"file\" accept=\"image/*\" onChange={e => handleFileChange(e, 'reference')} className=\"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:bg-purple-50 file:text-purple-700 hover:file:bg-purple-100\" />\r\n          </div>\r\n\r\n        </div>\r\n\r\n        {/* Timeline 區 */}\r\n        <div className=\"bg-white rounded-lg shadow-lg p-4\">\r\n          <h2 className=\"text-lg font-semibold mb-4 text-gray-900\">Chats in this project</h2>\r\n          {timelineNodes.length > 0 ? (\r\n            <div className=\"space-y-2\">\r\n              {timelineNodes.map((node, index) => (\r\n                <div key={node.id || index} className=\"p-3 bg-white rounded-md hover:bg-purple-50 transition-colors shadow-lg\">\r\n                  <div className=\"flex items-start justify-between\">\r\n                    <div onClick={() => setCurrentPrompt(node.data.prompt)} className=\"flex items-start space-x-3 cursor-pointer flex-1\">\r\n                      {node.data.imageUrl && <img src={node.data.imageUrl} alt={node.data.prompt} className=\"w-12 h-12 object-cover rounded-md\" />}\r\n                      <div className=\"flex-1 min-w-0\">\r\n                        <p className=\"text-sm text-gray-800 truncate\">{node.data.prompt}</p>\r\n                        <div className=\"flex flex-wrap gap-1 mt-1\">\r\n                          {node.data.tags?.map((tag: string, idx: number) => (\r\n                            <span key={idx} className=\"px-2 py-1 text-xs bg-purple-100 text-purple-700 rounded-full\">{tag}</span>\r\n                          ))}\r\n                        </div>\r\n                        <p className=\"text-xs text-gray-500 mt-1\">{new Date(node.data.timestamp).toLocaleString()}</p>\r\n                      </div>\r\n                    </div>\r\n                    <button onClick={() => handlePromptSubmit(node.data.prompt, node.data.prompt)} className=\"ml-2 px-3 py-1.5 bg-purple-600 hover:bg-purple-700 text-white text-xs font-medium rounded transition-colors\">\r\n                      重新使用\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <p className=\"text-gray-500\">No history found yet.</p>\r\n          )}\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CasePage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}